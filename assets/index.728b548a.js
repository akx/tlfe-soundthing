var D=Object.defineProperty,L=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var C=(e,n,t)=>n in e?D(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,E=(e,n)=>{for(var t in n||(n={}))y.call(n,t)&&C(e,t,n[t]);if(p)for(var t of p(n))v.call(n,t)&&C(e,t,n[t]);return e},b=(e,n)=>L(e,P(n));var T=(e,n)=>{var t={};for(var a in e)y.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&p)for(var a of p(e))n.indexOf(a)<0&&v.call(e,a)&&(t[a]=e[a]);return t};import{R as o,u as w,s as u,a as G}from"./vendor.51d81fb6.js";const z=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}};z();function Q(e,n,t){const a=[];for(let r=e;r<n;r++)a.push(t(r));return a}function N(e){let n=e[0];for(let t=1;t<e.length;t++)n=Math.max(Math.abs(e[t]),n);return n}function j(e,n){const{width:t,height:a}=e.canvas,r=new Uint8Array(256);n.getByteFrequencyData(r),e.beginPath(),e.moveTo(0,a);const l=N(r);for(let s=0;s<r.length;s++){const c=s/r.length*t,d=r[s]/l*a;e.lineTo(c,a-d)}e.lineTo(t,a),e.lineTo(0,a),e.closePath(),e.fill()}function H(e,n){const t=new Float32Array(512),{width:a,height:r}=e.canvas,l=r/2;n.getFloatTimeDomainData(t);const s=N(t);e.beginPath(),e.strokeStyle="1px solid black";for(let c=0;c<t.length;c++){const d=c/t.length*a,f=l+t[c]/s*l;c===0?e.moveTo(d,f):e.lineTo(d,f)}e.stroke()}function V({vizNode:e}){const n=o.useRef(null),t=o.useCallback(()=>{const a=n.current;if(!a)return;const r=a.getContext("2d");!r||(a.width=+a.width,r.fillStyle=`hsl(${+new Date/100%360}, 100%, 60%)`,j(r,e),H(r,e))},[e]);return w(t,30),o.createElement("canvas",{width:800,height:300,style:{width:"100%",border:"1px solid orange"},ref:n})}const S=u.label`
  display: flex;
  justify-content: space-between;
  padding: 0.5em;
`,x=u.span`
  padding-right: 1em;
  white-space: nowrap;
`,W=u.span`
  padding-left: 1em;
  white-space: nowrap;
  width: 5em;
  text-align: right;
`,_=u.input`
  flex: 1;
`;function h(l){var s=l,{label:e,unit:n,onChange:t,value:a}=s,r=T(s,["label","unit","onChange","value"]);const c=o.useCallback(d=>t(d.target.valueAsNumber),[t]);return o.createElement(S,null,o.createElement(x,null,e),o.createElement(_,b(E({},r),{type:"range",onChange:c,value:a})),o.createElement(W,null,a,n?` ${n}`:null))}function $(e,n=440){return Math.pow(2,(e-69)/12)*n}const K=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function U(e){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const n=K[e%12],t=Math.floor(e/12)-1;return n+t}const X=u.div({display:"grid",gridTemplateColumns:new Array(12).fill("1fr").join(" "),gap:"3px"}),J=u.button({padding:".5em"}),Y=2,Z=11;function ee({onClickNote:e}){const n=o.useCallback(t=>{e(String(t.currentTarget.dataset.note))},[e]);return o.createElement(X,null,Q(Y*12,Z*12,t=>o.createElement(J,{key:t,"data-note":t,onClick:n},U(t))))}function k({label:e,options:n,onChange:t,value:a}){const r=o.useCallback(l=>t(String(l.currentTarget.dataset.value)),[t]);return o.createElement(S,null,o.createElement(x,null,e),o.createElement("div",{style:{display:"flex",flex:1,gap:"1em"}},n.map(([l,s])=>o.createElement("button",{"data-value":l,key:String(l),onClick:r,style:{flex:1,fontWeight:a===l?"bold":void 0}},s))))}function te(){const e=new AudioContext,n=e.createOscillator(),t=e.createBiquadFilter(),a=e.createAnalyser();return a.fftSize=512,a.smoothingTimeConstant=.3,n.connect(t),t.connect(e.destination),t.connect(a),{audioContext:e,oscNode:n,filterNode:t,vizNode:a}}const ne=[["sawtooth","Saw"],["sine","Sin"],["square","Sqr"],["triangle","Tri"]],oe=[["bandpass","Bandpass"],["highpass","Highpass"],["lowpass","Lowpass"],["notch","Notch"],["peaking","Peaking"]],M=432;function ae(e,n,t){const a=o.useMemo(()=>n.split(/\s+/).map(l=>+l).filter(Boolean),[n]),r=o.useMemo(()=>{const l=t%a.length,s=a[l],c=$(s,M)||M;return Math.min(22050,Math.max(0,c))},[t,a]);o.useEffect(()=>{const l=e.current;l.oscNode.frequency.value=r},[r])}const re=u.div({display:"flex",">div":{flex:1},gap:"1em",padding:"1em"}),le=u.div({background:"#BDC581",padding:"1em"}),se=u.input({width:"100%"});function ce(){const[e]=o.useState(()=>te()),[n,t]=o.useState("44 66 89 30"),[a,r]=o.useState(120),[l,s]=o.useState(800),[c,d]=o.useState(1),[f,F]=o.useState("lowpass"),[m,q]=o.useState("square"),[A,O]=o.useState(0),g=o.useRef(e);g.current=e;const B=o.useCallback(()=>{O(i=>i+1)},[]);w(B,6e4/(a*4)),ae(g,n,A),o.useEffect(()=>{const i=g.current;i.oscNode.type=m,i.filterNode.frequency.value=l,i.filterNode.Q.value=c,i.filterNode.type=f},[l,c,f,m]);const I=o.useCallback(i=>{t(R=>(R+" "+i).trim())},[]);return o.createElement("div",{className:"App"},o.createElement(le,null,o.createElement("button",{onClick:()=>{e.audioContext.resume(),e.oscNode.start()}},"Go")),o.createElement(re,null,o.createElement("div",null,o.createElement(h,{label:"Tempo",value:a,unit:"BPM",onChange:r,min:20,max:300}),o.createElement(h,{label:"Filter Frequency",value:l,unit:"Hz",onChange:s,min:400,max:22e3}),o.createElement(h,{label:"Filter Q",value:c,onChange:d,min:0,max:50,step:.01}),o.createElement(k,{label:"Filter Type",value:f,options:oe,onChange:F}),o.createElement(k,{label:"Oscillator Type",value:m,options:ne,onChange:q})),o.createElement("div",null,o.createElement(se,{type:"text",value:n,onChange:i=>t(i.target.value)}),o.createElement(ee,{onClickNote:I})),o.createElement("div",null,o.createElement(V,{vizNode:e.vizNode}))))}G.render(o.createElement(o.StrictMode,null,o.createElement(ce,null)),document.getElementById("root"));
