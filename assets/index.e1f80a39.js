var G=Object.defineProperty,z=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var w=(e,n,t)=>n in e?G(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,N=(e,n)=>{for(var t in n||(n={}))b.call(n,t)&&w(e,t,n[t]);if(p)for(var t of p(n))T.call(n,t)&&w(e,t,n[t]);return e},S=(e,n)=>z(e,Q(n));var x=(e,n)=>{var t={};for(var a in e)b.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&p)for(var a of p(e))n.indexOf(a)<0&&T.call(e,a)&&(t[a]=e[a]);return t};import{R as o,u as k,s as u,a as j}from"./vendor.51d81fb6.js";const H=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}};H();function V(e,n=440){return Math.pow(2,(e-69)/12)*n}const W=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function _(e){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const n=W[e%12],t=Math.floor(e/12)-1;return n+t}function $(e,n,t){const a=[];for(let l=e;l<n;l++)a.push(t(l));return a}function M(e){let n=e[0];for(let t=1;t<e.length;t++)n=Math.max(Math.abs(e[t]),n);return n}function K(e,n){const{width:t,height:a}=e.canvas,l=new Uint8Array(256);n.getByteFrequencyData(l),e.beginPath(),e.moveTo(0,a);const r=M(l);for(let s=0;s<l.length;s++){const c=s/l.length*t,d=l[s]/r*a;e.lineTo(c,a-d)}e.lineTo(t,a),e.lineTo(0,a),e.closePath(),e.fill()}function U(e,n){const t=new Float32Array(512),{width:a,height:l}=e.canvas,r=l/2;n.getFloatTimeDomainData(t);const s=M(t);e.beginPath(),e.strokeStyle="1px solid black";for(let c=0;c<t.length;c++){const d=c/t.length*a,f=r+t[c]/s*r;c===0?e.moveTo(d,f):e.lineTo(d,f)}e.stroke()}function X({vizNode:e}){const n=o.useRef(null),t=o.useCallback(()=>{const a=n.current;if(!a)return;const l=a.getContext("2d");!l||(a.width=+a.width,l.fillStyle=`hsl(${+new Date/100%360}, 100%, 60%)`,K(l,e),U(l,e))},[e]);return k(t,30),o.createElement("canvas",{width:800,height:300,style:{width:"100%",border:"1px solid orange"},ref:n})}const F=u.label`
  display: flex;
  justify-content: space-between;
  padding: 0.5em;
`,q=u.span`
  padding-right: 1em;
  white-space: nowrap;
`,J=u.span`
  padding-left: 1em;
  white-space: nowrap;
  width: 5em;
  text-align: right;
`,Y=u.input`
  flex: 1;
`;function y(r){var s=r,{label:e,unit:n,onChange:t,value:a}=s,l=x(s,["label","unit","onChange","value"]);const c=o.useCallback(d=>t(d.target.valueAsNumber),[t]);return o.createElement(F,null,o.createElement(q,null,e),o.createElement(Y,S(N({},l),{type:"range",onChange:c,value:a})),o.createElement(J,null,a,n?` ${n}`:null))}const Z=u.div({display:"grid",gridTemplateColumns:new Array(12).fill("1fr").join(" "),gap:"3px"}),ee=u.button({padding:".5em"}),te=2,ne=11;function oe({onClickNote:e}){const n=o.useCallback(t=>{e(String(t.currentTarget.dataset.note))},[e]);return o.createElement(Z,null,$(te*12,ne*12,t=>o.createElement(ee,{key:t,"data-note":t,onClick:n},_(t))))}function A({label:e,options:n,onChange:t,value:a}){const l=o.useCallback(r=>t(String(r.currentTarget.dataset.value)),[t]);return o.createElement(F,null,o.createElement(q,null,e),o.createElement("div",{style:{display:"flex",flex:1,gap:"1em"}},n.map(([r,s])=>o.createElement("button",{"data-value":r,key:String(r),onClick:l,style:{flex:1,fontWeight:a===r?"bold":void 0}},s))))}const ae=u.div({display:"flex",">div":{flex:1},gap:"1em",padding:"1em"}),le=u.div({background:"#BDC581",padding:"1em"}),re=u.input({width:"100%"});function se(){const e=new AudioContext,n=e.createOscillator(),t=e.createBiquadFilter(),a=e.createAnalyser();return a.fftSize=512,a.smoothingTimeConstant=.3,n.connect(t),t.connect(e.destination),t.connect(a),{audioContext:e,oscNode:n,filterNode:t,vizNode:a}}const ie=[["sawtooth","Saw"],["sine","Sin"],["square","Sqr"],["triangle","Tri"]],ce=[["bandpass","Bandpass"],["highpass","Highpass"],["lowpass","Lowpass"],["notch","Notch"],["peaking","Peaking"]],O=432;function ue(){const[e]=o.useState(()=>se()),[n,t]=o.useState("44 66 89 30"),[a,l]=o.useState(120),[r,s]=o.useState(800),[c,d]=o.useState(1),[f,I]=o.useState("lowpass"),[m,B]=o.useState("square"),[v,R]=o.useState(0),C=o.useRef(e);C.current=e;const D=o.useCallback(()=>{R(i=>i+1)},[]);k(D,6e4/(a*4));const g=o.useMemo(()=>n.split(/\s+/).map(i=>+i).filter(Boolean),[n]),E=o.useMemo(()=>{const i=v%g.length,h=g[i],P=V(h,O)||O;return Math.min(22050,Math.max(0,P))},[v,g]);o.useEffect(()=>{const i=C.current;i.oscNode.frequency.value=E,i.oscNode.type=m,i.filterNode.frequency.value=r,i.filterNode.Q.value=c,i.filterNode.type=f},[E,r,c,f,m]);const L=o.useCallback(i=>{t(h=>(h+" "+i).trim())},[]);return o.createElement("div",{className:"App"},o.createElement(le,null,o.createElement("button",{onClick:()=>{e.audioContext.resume(),e.oscNode.start()}},"Go")),o.createElement(ae,null,o.createElement("div",null,o.createElement(y,{label:"Tempo",value:a,unit:"BPM",onChange:l,min:20,max:300}),o.createElement(y,{label:"Filter Frequency",value:r,unit:"Hz",onChange:s,min:400,max:22e3}),o.createElement(y,{label:"Filter Q",value:c,onChange:d,min:0,max:50,step:.01}),o.createElement(A,{label:"Filter Type",value:f,options:ce,onChange:I}),o.createElement(A,{label:"Oscillator Type",value:m,options:ie,onChange:B})),o.createElement("div",null,o.createElement(re,{type:"text",value:n,onChange:i=>t(i.target.value)}),o.createElement(oe,{onClickNote:L})),o.createElement("div",null,o.createElement(X,{vizNode:e.vizNode}))))}j.render(o.createElement(o.StrictMode,null,o.createElement(ue,null)),document.getElementById("root"));
