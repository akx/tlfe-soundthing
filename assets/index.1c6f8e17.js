import{R as o,u as h,a as v}from"./vendor.2c090166.js";const N=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}};N();function E(e,r=440){return Math.pow(2,(e-69)/12)*r}const C=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function b(e){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const r=C[e%12],a=Math.floor(e/12)-1;return r+a}function q(){const e=new AudioContext,r=e.createOscillator();r.type="square";const a=e.createBiquadFilter();a.frequency.value=800,a.type="lowpass";const c=e.createAnalyser();return c.fftSize=512,c.smoothingTimeConstant=.3,r.connect(a),a.connect(e.destination),a.connect(c),{audioContext:e,oscNode:r,filterNode:a,vizNode:c}}function y(e){let r=e[0];for(let a=1;a<e.length;a++)r=Math.max(Math.abs(e[a]),r);return r}function A({vizNode:e}){const r=o.useRef(null),a=o.useCallback(()=>{const c=r.current;if(!c)return;const n=new Float32Array(512),l=new Uint8Array(256);e.getFloatTimeDomainData(n),e.getByteFrequencyData(l);const s=c.getContext("2d");c.width=+c.width;const{width:f,height:u}=c,d=u/2,m=y(n);s.beginPath(),s.strokeStyle="1px solid black";for(let t=0;t<n.length;t++){const i=t/n.length*f,p=d+n[t]/m*d;t===0?s.moveTo(i,p):s.lineTo(i,p)}s.stroke(),s.fillStyle="orangered",s.globalAlpha=.6,s.beginPath(),s.moveTo(0,0);const g=y(l);for(let t=0;t<l.length;t++){const i=t/l.length*f,p=l[t]/g*u;s.lineTo(i,u-p)}s.lineTo(f,u),s.lineTo(0,u),s.closePath(),s.fill()},[e]);return h(a,30),o.createElement("canvas",{width:800,height:300,style:{width:"40%",border:"1px solid orange"},ref:r})}const x=432;function w(e,r,a){const c=[];for(let n=e;n<r;n++)c.push(a(n));return c}function M(){const[e]=o.useState(()=>q()),[r,a]=o.useState("44 66 89 30"),[c,n]=o.useState(120),[l,s]=o.useState(800),[f,u]=o.useState(0);h(()=>{u(t=>t+1)},6e4/(c*4));const d=o.useMemo(()=>r.split(/\s+/).map(t=>+t).filter(Boolean),[r]),m=o.useMemo(()=>{const t=f%d.length,i=d[t];return E(i,x)||x},[f,d]);o.useEffect(()=>{e.oscNode.frequency.value=m,e.filterNode.frequency.value=l},[e.filterNode.frequency,e.oscNode.frequency,m,l]);const g=o.useCallback(t=>{a(i=>(i+" "+t).trim())},[]);return o.createElement("div",{className:"App"},o.createElement("button",{onClick:()=>{e.audioContext.resume(),e.oscNode.start(),console.log(e.audioContext.state)}},"Go"),o.createElement("hr",null),o.createElement("input",{type:"text",value:r,onChange:t=>a(t.target.value)}),o.createElement("input",{type:"range",min:20,max:300,value:c,onChange:t=>n(t.target.valueAsNumber)}),c,o.createElement("hr",null),o.createElement("input",{type:"range",min:400,max:22e3,value:l,onChange:t=>s(t.target.valueAsNumber)}),o.createElement("hr",null),o.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},w(20,150,t=>o.createElement("button",{key:t,onClick:()=>g(String(t))},b(t)))),o.createElement("hr",null),o.createElement(A,{vizNode:e.vizNode}))}v.render(o.createElement(o.StrictMode,null,o.createElement(M,null)),document.getElementById("root"));
